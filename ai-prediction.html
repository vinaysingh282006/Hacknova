<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pollution Prediction | EcoPulse</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0/dist/tf.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1a0033 0%, #2d1b4e 50%, #1a0033 100%);
            min-height: 100vh;
        }
        
        .ai-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(168, 85, 247, 0.05) 100%);
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 1rem;
            padding: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(99, 102, 241, 0.1) 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.3);
        }
        
        .upload-zone {
            border: 2px dashed rgba(168, 85, 247, 0.5);
            border-radius: 1rem;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-zone:hover {
            border-color: rgba(168, 85, 247, 0.8);
            background: rgba(168, 85, 247, 0.05);
        }
        
        .btn-ai {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-ai:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
        }
        
        .btn-ai:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .loading-spinner {
            border: 3px solid rgba(168, 85, 247, 0.3);
            border-top: 3px solid #a855f7;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6 0%, #a855f7 100%);
            transition: width 0.3s ease;
        }
        
        .map-container {
            width: 100%;
            height: 500px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.75rem;
            position: relative;
            overflow: hidden;
        }
        
        .city-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .city-marker:hover {
            transform: scale(1.5);
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        /* Fancy animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        .animate-in {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animate-scale {
            animation: scaleIn 0.5s ease-out forwards;
        }
        
        .animate-slide {
            animation: slideInLeft 0.7s ease-out forwards;
        }
        
        .stat-card:hover {
            animation: pulse 0.5s ease-in-out;
        }
        
        .gradient-bg {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        /* Staggered animation delays */
        .gradient-bg:nth-child(1) { animation-delay: 0.1s; opacity: 0; }
        .gradient-bg:nth-child(2) { animation-delay: 0.2s; opacity: 0; }
        .gradient-bg:nth-child(3) { animation-delay: 0.3s; opacity: 0; }
        .gradient-bg:nth-child(4) { animation-delay: 0.4s; opacity: 0; }
        .gradient-bg:nth-child(5) { animation-delay: 0.5s; opacity: 0; }
        .gradient-bg:nth-child(6) { animation-delay: 0.6s; opacity: 0; }
        .gradient-bg:nth-child(7) { animation-delay: 0.7s; opacity: 0; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50" style="background: rgba(26, 0, 51, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(168, 85, 247, 0.2);">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="index.html" class="text-2xl font-bold">
                    <span style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">EcoPulse</span>
                </a>
                <div class="flex gap-6">
                    <a href="air.html" class="text-gray-300 hover:text-white transition">Air</a>
                    <a href="water.html" class="text-gray-300 hover:text-white transition">Water</a>
                    <a href="light.html" class="text-gray-300 hover:text-white transition">Light</a>
                    <a href="ai-prediction.html" class="text-purple-400 font-semibold">AI Prediction</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="ai-container" style="margin-top: 100px;">
        <!-- Header -->
        <div class="text-center mb-12">
            <h1 class="text-5xl font-bold mb-4">
                <span style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    AI Pollution Prediction
                </span>
            </h1>
            <p class="text-xl text-gray-300">Analyze historical data and predict future pollution trends with machine learning</p>
        </div>

        <!-- Data Upload Section -->
        <div class="gradient-bg mb-8" id="upload-section">
            <h2 class="text-2xl font-bold text-white mb-4">üìä Load Dataset</h2>
            <div class="upload-zone" id="upload-zone">
                <svg class="mx-auto mb-4" width="64" height="64" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                </svg>
                <p class="text-xl text-gray-300 mb-2">Click to upload CSV file or drag and drop</p>
                <p class="text-sm text-gray-500">Supports pollution datasets with temporal data</p>
                <input type="file" id="file-input" accept=".csv" class="hidden">
            </div>
            <div class="mt-4 flex gap-4">
                <button class="btn-ai" id="load-dataset1">Load City Dataset (2.5 MB)</button>
                <button class="btn-ai" id="load-dataset2">Load Station Dataset (214 MB) - Hourly</button>
            </div>
            <div id="loading-indicator" class="hidden mt-4 flex items-center justify-center gap-4">
                <div class="loading-spinner"></div>
                <span class="text-white">Loading data...</span>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8" id="stats-section" style="display: none;">
            <div class="stat-card">
                <div class="text-3xl mb-2">üìÖ</div>
                <div class="text-2xl font-bold text-white" id="stat-records">0</div>
                <div class="text-sm text-gray-400">Total Records</div>
            </div>
            <div class="stat-card">
                <div class="text-3xl mb-2">üèôÔ∏è</div>
                <div class="text-2xl font-bold text-white" id="stat-locations">0</div>
                <div class="text-sm text-gray-400">Locations</div>
            </div>
            <div class="stat-card">
                <div class="text-3xl mb-2">üìà</div>
                <div class="text-2xl font-bold text-white" id="stat-timespan">-</div>
                <div class="text-sm text-gray-400">Time Span</div>
            </div>
            <div class="stat-card">
                <div class="text-3xl mb-2">‚ö†Ô∏è</div>
                <div class="text-2xl font-bold text-white" id="stat-avg-aqi">-</div>
                <div class="text-sm text-gray-400">Avg PM2.5</div>
            </div>
        </div>

        <!-- Visualizations Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8" id="viz-section" style="display: none;">
            <!-- Time Series Chart -->
            <div class="gradient-bg">
                <h3 class="text-xl font-bold text-white mb-4">üìä Pollution Trends Over Time</h3>
                <div class="chart-container">
                    <canvas id="time-series-chart"></canvas>
                </div>
            </div>

            <!-- Pollutant Comparison -->
            <div class="gradient-bg">
                <h3 class="text-xl font-bold text-white mb-4">üî¨ Pollutant Levels Comparison</h3>
                <div class="chart-container">
                    <canvas id="pollutant-chart"></canvas>
                </div>
            </div>

            <!-- Heatmap -->
            <div class="gradient-bg">
                <h3 class="text-xl font-bold text-white mb-4">üóìÔ∏è Seasonal Patterns Heatmap</h3>
                <div class="chart-container">
                    <canvas id="heatmap-chart"></canvas>
                </div>
            </div>

            <!-- Distribution Chart -->
            <div class="gradient-bg">
                <h3 class="text-xl font-bold text-white mb-4">üìâ AQI Distribution</h3>
                <div class="chart-container">
                    <canvas id="distribution-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- Geographic Map -->
        <div class="gradient-bg mb-8" id="map-section" style="display: none;">
            <h3 class="text-xl font-bold text-white mb-4">üó∫Ô∏è Pollution Hotspots by Location</h3>
            <div class="map-container" id="pollution-map">
                <div class="tooltip" id="map-tooltip"></div>
            </div>
        </div>

        <!-- AI Model Training Section -->
        <div class="gradient-bg mb-8" id="training-section" style="display: none;">
            <h2 class="text-2xl font-bold text-white mb-4">ü§ñ Train AI Model</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div>
                    <label class="block text-gray-300 mb-2">Target Variable</label>
                    <select id="target-variable" class="w-full bg-gray-800 text-white p-3 rounded-lg border border-purple-500">
                        <option value="PM2.5">PM2.5 Concentration</option>
                        <option value="PM10">PM10 Concentration</option>
                        <option value="NO2">NO2 Concentration</option>
                        <option value="AQI">Air Quality Index</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-300 mb-2">Prediction Window</label>
                    <select id="prediction-window" class="w-full bg-gray-800 text-white p-3 rounded-lg border border-purple-500">
                        <option value="1">1 Day Ahead</option>
                        <option value="7">7 Days Ahead</option>
                        <option value="30">30 Days Ahead</option>
                    </select>
                </div>
            </div>
            <button class="btn-ai w-full mb-4" id="train-model-btn">
                üöÄ Start Training Model
            </button>
            <div id="training-progress" class="hidden">
                <div class="mb-2 flex justify-between text-sm text-gray-300">
                    <span>Training Progress</span>
                    <span id="progress-text">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white" id="training-loss">-</div>
                        <div class="text-sm text-gray-400">Training Loss</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white" id="training-accuracy">-</div>
                        <div class="text-sm text-gray-400">Accuracy</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prediction Interface -->
        <div class="gradient-bg" id="prediction-section" style="display: none;">
            <h2 class="text-2xl font-bold text-white mb-4">üîÆ Make Predictions</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div>
                    <label class="block text-gray-300 mb-2">Select Location</label>
                    <select id="pred-location" class="w-full bg-gray-800 text-white p-3 rounded-lg border border-purple-500">
                        <option value="">Loading...</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-300 mb-2">Select Date</label>
                    <input type="date" id="pred-date" class="w-full bg-gray-800 text-white p-3 rounded-lg border border-purple-500">
                </div>
                <div class="flex items-end">
                    <button class="btn-ai w-full" id="predict-btn">Predict</button>
                </div>
            </div>
            <div id="prediction-results" class="hidden">
                <h3 class="text-2xl font-bold text-white mb-6 text-center">üéØ Detailed Prediction Analytics</h3>
                
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="stat-card">
                        <div class="text-sm text-gray-400 mb-2">Predicted Value</div>
                        <div class="text-3xl font-bold text-white" id="pred-value">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-sm text-gray-400 mb-2">Confidence</div>
                        <div class="text-3xl font-bold text-white" id="pred-confidence">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-sm text-gray-400 mb-2">AQI Category</div>
                        <div class="text-3xl font-bold text-white" id="pred-category">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="text-sm text-gray-400 mb-2">Risk Level</div>
                        <div class="text-3xl font-bold text-white" id="pred-risk">-</div>
                    </div>
                </div>

                <!-- 7 Awesome Prediction Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    
                    <!-- 1. Forecast Timeline with Confidence Bands -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">üìà 7-Day Forecast Timeline</h4>
                        <div class="chart-container">
                            <canvas id="forecast-timeline-chart"></canvas>
                        </div>
                    </div>

                    <!-- 2. Historical vs Predicted Comparison -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">üîÑ Historical vs Predicted</h4>
                        <div class="chart-container">
                            <canvas id="comparison-chart"></canvas>
                        </div>
                    </div>

                    <!-- 3. Probability Distribution -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">üìä Probability Distribution</h4>
                        <div class="chart-container">
                            <canvas id="probability-chart"></canvas>
                        </div>
                    </div>

                    <!-- 4. Hourly Variation Forecast -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">‚è∞ Hourly Pattern Forecast</h4>
                        <div class="chart-container">
                            <canvas id="hourly-pattern-chart"></canvas>
                        </div>
                    </div>

                    <!-- 5. Multi-Pollutant Impact Analysis -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">üß™ Multi-Pollutant Impact</h4>
                        <div class="chart-container">
                            <canvas id="multi-pollutant-chart"></canvas>
                        </div>
                    </div>

                    <!-- 6. Risk Assessment Gauge -->
                    <div class="gradient-bg">
                        <h4 class="text-lg font-bold text-white mb-4">‚ö†Ô∏è Health Risk Assessment</h4>
                        <div class="chart-container">
                            <canvas id="risk-gauge-chart"></canvas>
                        </div>
                    </div>

                    <!-- 7. Weekly Trend Comparison -->
                    <div class="gradient-bg lg:col-span-2">
                        <h4 class="text-lg font-bold text-white mb-4">üìâ Weekly Trend Analysis</h4>
                        <div class="chart-container">
                            <canvas id="weekly-trend-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Action Recommendations -->
                <div class="gradient-bg mt-6">
                    <h4 class="text-lg font-bold text-white mb-4">üí° AI Recommendations</h4>
                    <div id="ai-recommendations" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Dynamically populated -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/data-loader.js"></script>
    <script src="js/ai-visualizations.js"></script>
    <script src="js/ai-model.js"></script>
</body>
</html>
